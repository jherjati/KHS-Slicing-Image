import Head from "next/head";
import Navbar from "../components/Navbar";
import Footer from "../components/Footer";
import HomePage from "../components/HomePage";
import { rootUrl } from "../constants";

export async function getStaticProps() {
  const slidesRes = await (
    await fetch(rootUrl + "/slides?_embed&_fields=acm_fields")
  ).json();

  const slides = slidesRes.map(({ acm_fields: { title, text, image } }) => ({
    title,
    text,
    image: image.source_url,
  }));

  return {
    props: {
      slides,
    },
    revalidate: 5 * 60 * 1000,
  };
}

export default function Home({ slides }) {
  return (
    <div>
      <Head>
        <title>Home - KHS</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/logo.ico' />
      </Head>
      <Navbar />
      <HomePage slides={slides} />
      <Footer />
    </div>
  );
}
